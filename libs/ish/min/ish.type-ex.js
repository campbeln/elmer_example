/* Class: ish; By: Nick Campbell; License: MIT; Keep this line or you violate the copyright! */
!function(){"use strict";function e(d){var h,v=d.config.ish().onServer,g=v?global:window,k=null;d.oop.partial(d.type,function(i){var o,e,r,t={is:{truthy:function(e){return 0!==e&&""!==e&&e!==k&&!1!==e&&e!==h&&!("number"==typeof e&&e!=e)},numeric:{eq:function(e,t){var r=!1;return d.type.is.numeric(e)&&d.type.is.numeric(t)&&(r=d.type.float.mk(e)===d.type.float.mk(t)),r},cmp:function(e,t){var r=h,n=d.type.float.mk(e,k),i=d.type.float.mk(t,k);return d.type.is.numeric(n)&&d.type.is.numeric(i)&&(r=n<i?-1:i<n?1:0),r},sum:function(e,t){var r,n=0;if(d.type.arr.is(e,!0))if(d.type.str.is(t,!0)||d.type.arr.is(t,!0))for(r=0;r<e.length;r++)n+=d.type.float.mk(d.resolve(e[r],t));else for(r=0;r<e.length;r++)n+=d.type.float.mk(e[r]);else if(d.type.obj.is(e,!0))for(r in e)e.hasOwnProperty(r)&&(n+=d.type.float.mk(e[r]));return n},stats:function(e,t){var r,n,i,o={},s={count:0,mode:[],values:[]};if(d.type.arr.is(e,!0)){if(s.sum=0,2===arguments.length)for(i=0;i<e.length;i++)n=d.type.float.mk(d.resolve(e[i],t)),s.sum+=n,s.values.push(n);else for(i=0;i<e.length;i++)n=d.type.float.mk(e[i]),s.sum+=d.type.float.mk(e[i]),s.values.push(n);for(s.count=s.values.length,s.mean=s.average=s.sum/s.count,s.values.sort(),s.count%2==1?(i=Math.floor(s.count/2),s.median=s.values[i]):(i=s.count/2,s.median=(s.values[i-1]+s.values[i])/2),i=0;i<s.count;i++)o[s.values[i]]=o[s.values[i]]||0,o[s.values[i]]++;for(r in n=1,o)o[r]>n?(n=o[r],s.mode=[d.type.float.mk(r)]):o[r]===n&&s.mode.push(d.type.float.mk(r));s.mode.sort(),s.range=s.values[s.count-1]-s.values[0]}return s}}},any:function(e,t,r){var n,i=!0===r?function(e,t){return e==t}:function(e,t){return e===t},o=!1;if(d.type.arr.is(t,!0))for(n=0;n<t.length;n++)if(i(e,t[n])){o=!0;break}return o},query:function(e,t,r){var n,i,o,s,a,u,p,f,y=[];if(t=d.type.arr.mk(t,[t]),r=d.extend({firstEntryOnly:!1,caseInsensitive:!1,useCoercion:!1},r),n=d.type.arr.is(e)?e:d.type.obj.is(e)?d.type.obj.toArr(e,r.setKeyAs):[e],d.type.arr.is(n,!0))for(a=0;a<t.length;a++)if(i=d.type.obj.is(t[a])?Object.keys(t[a]):h,d.type.arr.is(i,!0))for(u=0;u<n.length;u++){for(p=0;p<i.length;p++){if(s=!1,o=t[a][i[p]],d.type.arr.is(o)){for(f=0;f<o.length;f++)if(l(i[p],o[f],n[u],r)){s=!0;break}}else s=l(i[p],o,n[u],r);if(!r.or&&!s||r.or&&s)break}if(s&&(y.push(n[u]),r.firstEntryOnly)){a=t.length;break}}return r.firstEntryOnly?y[0]:y},uuid:(e=d.type.fn.is(g.Uint8Array)&&d.type.fn.is(d.resolve(g,"crypto.getRandomValues"))?function(e){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(e){return(e^g.crypto.getRandomValues(new g.Uint8Array(1))[0]&15>>e/4).toString(16)}).replace(/^(.{13})-4/,"$1-"+c(e))}:function(e){return r=Date.now()+(d.type.fn.call(d.resolve(g,"performance.now"))||0),"xxxxxxxx-xxxx-"+c(e)+"xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=(r+16*Math.random())%16|0;return r=Math.floor(r/16),("x"===e?t:3&t|8).toString(16)})},d.extend(e,{is:function(e,t){var r=d.type.obj.mk(t),n=!0===t||!0===r.excludeNilUUID,i=c(r.version)===r.version?r.version:"1-5",o=new RegExp(n?"^[0-9a-f]{8}-[0-9a-f]{4}-["+i+"][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$":"^[0-9a-f]{8}-[0-9a-f]{4}-[0,"+i+"][0-9a-f]{3}-[089ab][0-9a-f]{3}-[0-9a-f]{12}$","i"),s=!1;return d.type.str.is(e,!0)&&(r.allowBrackets&&(e=d.type.uuid.format(e)),s=o.test(e)),s},mk:function(e,t){return d.type.uuid.is(e,!0)?e:1<arguments.length?t:d.type.uuid()},format:function(e,t){return e=d.type.str.mk(e).trim().replace(/^\{/,"").replace(/\}$/,"")[!0===t?"toUpperCase":"toLowerCase"](),/^[0-9a-f]{32}$/i.test(e)&&(e=e.replace(/^([a-f0-9]{8})([a-f0-9]{4})([a-f0-9]{4})([a-f0-9]{4})([a-f0-9]{12})$/i,"$1-$2-$3-$4-$5")),d.type.uuid.is(e)?e:""}})),date:{eq:function(e,t){var r=d.type.date.mk(e,k),n=d.type.date.mk(t,k);return d.type.date.is(r)&&d.type.date.is(n)&&r<=n&&n<=r},cmp:function(e,t){var r=h,n=d.type.date.mk(e,k),i=arguments.length<2?new Date:d.type.date.mk(t,k);return d.type.date.is(n)&&d.type.date.is(i)&&(r=n<i?-1:i<n?1:0),r},cp:function(e){var t,r=d.type.date.mk(e,k);return d.type.date.is(r)&&(t=new Date(r.getTime())),t},age:function(e){var t,r=d.type.date.mk(e,k),n=-1;return d.type.date.is(r)&&(t=new Date(Date.now()-d.type.date.mk(r,k)),n=Math.abs(t.getUTCFullYear()-1970)),n},only:function(e,t){return d.type.date.mk(d.type.date.yyyymmdd.apply(this,[e,t])+" 00:00:00")},utcToLocalOffset:function(e){var t=d.type.date.mk(e);return new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds())}},str:{eq:function(e,t,r){return e=d.type.str.mk(e,""),t=d.type.str.mk(t,""),!1!==r?e.toLowerCase()===t.toLowerCase():e===t},cmp:function(e,t){var r,n=!1;if(d.type.arr.is(t))for(r=0;r<t.length&&!(n=y(e,t[r]));r++);else n=y(e,t);return n},lpad:function(e,t,r){return a(e,t,r,!0)},rpad:function(e,t,r){return a(e,t,r,!1)},begins:function(e,t){return p(e,d.type.arr.mk(t,[t]),function(e){return 0===e})},ends:function(e,t){return p(e,d.type.arr.mk(t,[t]),function(e,t,r){return e===t-r})},contains:function(e,t){return p(e,d.type.arr.mk(t,[t]),function(e){return-1<e})},sub:function(e,t,r){var n=d.type.str.mk(e),i=d.type.int.mk(t),o=n.length-d.type.int.mk(r);return n.substring(i<0?0:i,o<0?0:o)},replace:(o=/{([^{]+)}/g,function(e,r,t){var n,i;return e=d.type.str.mk(e),r=d.type.obj.mk(r),n=(t=d.type.obj.mk(t)).pattern||o,t.start&&t.end&&(n=new RegExp(t.start+"([^"+t.start+"]+)"+t.end,"g")),e.replace(n,function(e,t){return i=d.resolve(r,t),d.type.fn.is(i)?i():d.type.str.mk(i)})})},arr:{cmp:function(e,t,r){var n,i,o,s=d.type.arr.is(e)&&d.type.arr.is(t)&&e.length===t.length,a=s?e.length:0;if(s){for(o=0;o<a;o++)if(e[o]!==t[o]){if(e[o]!=t[o]){s=!r&&2;break}s=1}if(2===s)for(n=t.slice(0),o=0;o<a;o++){if(-1===(i=n.indexOf(e[o]))){s=!1;break}n.splice(i,1)}}return s},cp:function(e,t){var r,n,i;if(t=d.type.int.mk(!0===t?-1:t,0),d.type.arr.is(e))if(0!==t)for(i=[],n=0;n<e.length;n++)r=e[n],d.type.arr.is(r)?i.push(d.type.arr.cp(r,t-1)):d.type.obj.is(r)?i.push(d.type.obj.cp(r,t-1)):d.type.date.is(r)?i.push(d.type.date.cp(r)):d.type.fn.is(r)?i.push(d.type.fn.cp(r)):d.type.dom.is(r)?i.push(d.type.dom.cp(r,!0)):i.push(r);else i=e.slice(0);return i},unique:function(e,t,r){var n=[];return r=!0===r||!0===t,d.type.arr.is(e)&&(n=d.type.arr.is(t)?e.filter(function(e){return-1===t.indexOf(e)&&(!r||-1===t.indexOf((e+"").toLowerCase()))}):e.reduce(function(e,t){return-1!==e.indexOf(t)||r&&-1!==e.indexOf((t+"").toLowerCase())||e.push(t),e},[])),n},matches:function(e,t){var r=[];return d.type.arr.is(e)&&d.type.arr.is(t)&&(r=e.filter(function(e){return-1!==t.indexOf(e)})),r},randomize:function(e){var t=[];return d.type.arr.is(e)&&(t=e.sort(function(){return.5<=Math.random()?-1:1})),t},extract:function(e,t){var r,n=[];if(d.type.arr.is(e))for(r=0;r<e.length;r++)n.push(d.resolve(e,t));return n},countOf:function(e,t){var r=0;return d.type.arr.is(e)&&(r=e.filter(function(e){return e===t}).length),r},sort:d.extend(function(e,t){var r=d.type.arr.mk(e).slice(0).sort();return t?r.reverse():r},{natural:function(e,t){if(d.type.arr.is(e)){var r=e.slice(0).sort(n);return!0===t?r.reverse():r}},by:function(e,t){var r,n=d.type.obj.mk(t),i=d.type.str.mk(n.path),o=!0===n.reverse,s=d.type.fn.mk(n.compare,function(e,t){return!(d.resolve(e,i)<d.resolve(t,i)&&o)});return d.type.arr.is(e,!0)&&(r=e.slice(0)).sort(s),r}})},obj:{eq:function(e,t,r){var n,i,o=d.type.obj.ownKeys(e),s=d.type.obj.ownKeys(t),a=!1;if(d.type.arr.cmp(o,s))for((r=d.extend({useCoercion:!0,caseInsensitive:!1,trimWhitespace:!1,maxDepth:0},r)).maxDepth=!1===r.maxDepth?0:!0===r.maxDepth?-1:d.type.int.mk(r.maxDepth),n=u(r),a=!0,i=0;i<o.length;i++)if(!n(e[o[i]],t[o[i]])){a=!1;break}return a},cp:function(e,t){var r;return d.type.obj.is(e)&&(r=t?d.extend(t,{},e):d.extend({},e)),r},clone:function(e,t){var r,n,i,o={};if(d.type.str.is(t)&&(t=[t]),d.type.obj.is(t,{strict:!0}))o=t,n=d.type.obj.ownKeys(o);else if(d.type.arr.is(t)?n=t:d.type.obj.is(e)&&(n=d.type.obj.ownKeys(e)),n)for(r=0;r<n.length;r++)o[n[r]]=n[r];if(n)if(d.type.arr.is(e))for(i=[],r=0;r<e.length;r++)i.push(s(e[r],o,n));else d.type.obj.is(e)&&(i=s(e,o,n));return i},toArr:function(e,t){var r,n,i=d.type.str.is(t,!0),o=d.type.obj.is(e,{allowFn:!0})?Object.keys(e):h;if(o)for(r=[],n=0;n<o.length;n++)r.push(e[o[n]]),i&&(e[o[n]][t]=o[n]);return r},join:function(e,t,r){var n,i=d.type.obj.ownKeys(e),o=d.type.str.is(r),s="";if(t=d.type.str.mk(t),i){if(o){for(n=0;n<i.length-1;n++)s+=i[n]+r+e[i[n]]+t;s+=i[n]+r}else for(n=0;n<i.length-1;n++)s+=e[i[n]]+t;s+=e[i[n]]}return s},mv:function(e,t,r){var n=d.type.obj.is(t,{nonEmpty:!0});return n=n&&i.processObj(e,t,r)},has:function(e,t,r){var n,i=d.type.arr.is(t)?t:[t],o=d.type.fn.is(e,{allowFn:!0});if(o)if(r){for(n=0;n<i.length;n++)if(!d.resolve(d.resolve.returnMetadata,e,i[n]).existed){o=!1;break}}else for(n=0;n<i.length;n++)if(!e.hasOwnProperty(i[n])){o=!1;break}return o},prune:function(e,t){var r,n,i=d.type.obj.ownKeys(e),o=d.type.obj.empty();for(t=d.type.arr.mk(t,t),n=0;n<i.length;n++)e[r=i[n]]!==h&&-1===t.indexOf(r)&&(o[r]=e[r]);return o},diff:function(e,t,r){var n,i,o=d.type.obj.ownKeys(e),s=d.type.obj.ownKeys(t),a=d.type.obj.empty();if(d.type.arr.is(o)&&d.type.arr.is(s)){if(n=u(r=d.extend({useCoercion:!0,caseInsensitive:!0,trimWhitespace:!0,includeMissingKeys:!0,caseInsensitiveKeys:!0,pruneUndefinedValues:!1},r,{maxDepth:null})),r.caseInsensitiveKeys)for(i=0;i<o.length;i++)n(d.type.obj.get(e,o[i]),d.type.obj.get(t,o[i]))||(a[o[i]]=t[o[i]]),d.type.arr.rm(s,o[i]);else for(i=0;i<o.length;i++)n(e[o[i]],t[o[i]])||(a[o[i]]=t[o[i]]),d.type.arr.rm(s,o[i]);if(r.includeMissingKeys)for(i=0;i<s.length;i++)a[s[i]]=t[s[i]]}return r.pruneUndefinedValues?d.type.obj.prune(a):a},resolveFirst:function(e,t){var r,n,i;if(d.type.obj.is(e)&&d.type.arr.is(t,!0))for(r=0;r<t.length;r++)if((n=d.resolve(d.resolve.returnMetadata,e,t[r])).existed){i=n.value;break}return i},empty:function(){return Object.create(k)}}};function s(e,t,r){var n,i,o={};for(i=0;i<r.length;i++)o[t[n=r[i]]]=e[n];return o}function u(r){var i=[];return i.push(r.useCoercion?function(e,t){return e==t}:function(e,t){return e===t}),i.push(r.caseInsensitive?r.trim?function(e,t){return d.type.str.is(e)&&d.type.str.cmp(e,t)}:function(e,t){return d.type.str.is(e)&&d.type.str.ep(e,t,!0)}:r.trim?function(e,t){return d.type.str.is(e)&&d.type.str.mk(e).trim()===d.type.str.mk(t).trim()}:function(e,t){return d.type.str.is(e)&&d.type.str.mk(e)===d.type.str.mk(t)}),d.type.int.is(r.maxDepth)&&0!==r.maxDepth&&i.push(function(e,t){return d.type.obj.is(e)&&d.type.obj.eq(e,t,d.extend({},r,{maxDepth:r.maxDepth-1}))}),d.type.fn.is(r.compare)&&i.push(r.compare),function(e,t){var r,n=!1;for(r=0;r<i.length;r++)if(i[r](e,t)){n=!0;break}return n}}function n(e,t){var r,n,i,o=[],s=[];for(e.replace(/(\d+)|(\D+)/g,function(e,t,r){o.push([t||1/0,r||""])}),t.replace(/(\d+)|(\D+)/g,function(e,t,r){s.push([t||1/0,r||""])});o.length&&s.length;)if(r=o.shift(),n=s.shift(),i=r[0]-n[0]||r[1].localeCompare(n[1]))return i;return o.length-s.length}function a(e,t,r,n){var i=d.type.str.mk(e);if(r=d.type.int.mk(r),t=d.type.str.mk(t," "),n)for(;i.length<r;)i=t+i;else for(;i.length<r;)i+=t;return i}function p(e,t,r){var n,i,o=!1;for(n=0;n<t.length;n++){if(!0===(i=f(e,t[n],r))){o=i;break}!1!==i&&(o=i)}return o}function f(e,t,r){var n=d.type.str.mk(e),i=d.type.str.mk(t),o=!1;return r(n.indexOf(i),n.length,i.length)?o=!0:(n=n.trim().toLowerCase(),i.trim().toLowerCase(),r(n.indexOf(i),n.length,i.length)&&(o=1)),o}function y(e,t){var r=!1,n=d.type.str.mk(e),i=d.type.str.mk(t);return n===i?r=!0:n.trim().toLowerCase()===i.trim().toLowerCase()&&(r=1),r}function c(e){return(e=d.type.int.mk(e,0))<1||5<e?4:e}function l(e,t,r,n){var i=n.caseInsensitive?d.type.obj.get(r,e):d.resolve(r,e);return d.type.fn.is(t)?t(i,r,n):t instanceof RegExp?!!d.type.str.mk(i).match(t):d.type.obj.is(r)&&n.useCoercion&&i==t||i===t}function m(e,t,r){var n,i=d.type.dom.mk(e,null),o=d.type.dom.mk(t,null),s=!(!i||!t);if(s)if(d.type.arr.is(t))if(r)for(n=t.length;0<n;n--)(o=d.type.dom.mk(t[n],null))&&i.insertBefore(o,i.childNodes[0]);else for(n=0;n<t.length;n++)(o=d.type.dom.mk(t[n],null))&&i.appendChild(o);else d.type.dom.is(o)&&(r?i.insertBefore(o,i.childNodes[0]):i.appendChild(o));return s}return v||(t.dom={cp:function(e,t){if(d.type.dom.is(e)&&d.type.fn.is(e.cloneNode))return e.cloneNode(!0===t)},prepend:function(e,t){return m(e,t,!0)},append:function(e,t){return m(e,t)},replace:function(e,t){var r=d.type.dom.mk(e,null),n=t?d.type.dom.parse(t)[0]:null,i=!(!r||!r.parentNode);return i&&(n?r.parentNode.replaceChild(n,r):r.remove()),i}}),t})}"object"==typeof module&&module.exports?module.exports=e:"function"==typeof define&&define.amd?define([],e):e(document.querySelector("SCRIPT[ish]").ish)}();
